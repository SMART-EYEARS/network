# 📚 들어가면서 
**네트워크 계층**에서 다른 네트워크로 데이터를 전송하는 데에는 **라우터**가 필요하다   
라우터의 라우팅 기능을 이용하여 데이터를 전송할 때,   

* 라우팅 정보가 잘못되었다.    
* 많은 라우터를 경유하는 도중에 라우터에 문제가 생겼다.    
* 패킷이 손상되었다.     
  
위와 같은 문제들로 인하여, **패킷이 손상되면 데이터가 수신지에 도착하지 못할 수 있다.**      
   
**`물리`**`+`**`데이터링크`**`+`**`네트워크`** 를 이용하면 데이터를 전송할 수 있다.     
하지만, **전송중인 데이터가 손상되거나 분실되면 아무런 후속 작업을 해줄 수 없다.**       

# 📕 전송 계층     
전송 계층은 **수신지에 신뢰할 수 있는 데이터를 전송하기 위해 필요한 계층이다.**     
전송 계층은 **`오류를 점검하는 기능을 가지고 있기 때문에`**      
데이터에 오류가 발생하면 **송신측에 재 전송을 요청할 수 있다.**    
        
쉽게 설명하면, **`물리`**`+`**`데이터링크`**`+`**`네트워크`** 까지는 데이터를 전송,              
**전송 계층**은 데이터가 제대로 도착했는지 확인할 수 있다. 
      
그리고 전송 계층은 **전송된 데이터가 어떤 Application에서 사용되는지 확인도 가능하다.**                        
정확히 말하면, 수신된 데이터가 어떤 응용 프로그램에서 사용하는 것인지 판단해야한다.         
예를 들면, `웹 페이지에서 사용하는 데이터`가 오면 이를 `크롬`과 같은 브라우저에 알려줘야하기 때문이다.      
   
___   
     
전송 계층은 TCP/UDP와 관련도니 계층으로 **오류 복구**와 **흐름제어**를 담당하며    
두 시스템 간에 **신뢰성 있는 데이터를 전송하기 위해 존재**한다.   
(그렇기 때문에, 단순히 **전송**만 하는 라우터는 네트워크 계층(3계층)이다.)               
   
또한, 수신시에는 **세션 계층의 어느 애플리케이션에 보낼지 판단**하고,      
손신시에는 네트워크 계층으로 전송할 경로를 선택한다.     

시스템 종단 간에 **투명한 데이터를 양방향으로 전송**하는 계층으로,   
네트워크 계층에서 전송한 데이터와 실제 운영체제의 프로그램이 연결되는 통신경로라 볼 수 있다.   
**`네트워크`** `<-전송계층->` **`실제 OS 프로그램`**   

  
|역할|개념|주요 기술|  
|---|----|---------|   
|종단간 연결|-종단 간 에러 없이 메시지 전송 연결 제공|– 에러 여부 확인<br>-3way-handshake|
|서비스지점<br>주소 지정|– Port 이용하여 프로세스 통신 제공 기능|– 송수신 포트 주소<br>– ftp(21), http(80) 등|
|다중화<br>역다중화|– 세그먼트 통합 및 전송, 적절한 port로 배분|– MUX, DEMUX 활용<br>– Header 정보 기반|  
|분할<br>재조립|– 메시지를 세그먼트 단위 분할, 순서대로 재조립|-세그먼트 순서정보<br>– 손실 패킷 발견|   
            
필히 참고 바람 : http://blog.skby.net/%EC%A0%84%EC%86%A1-%EA%B3%84%EC%B8%B5-transport-layer/     
 
# 📗 TCP
TCP는 **`연결지향형 프로토콜`** 로 **신뢰성 있는 바이트 스트림 서비스를 제공한다.**   
      
**연결지향**      
응용 프로그램이 데이터를 교환하기 전에 서로 TCP 연결을 확립해야한다.     
      
**신뢰성**   
데이터를 성공적으로 수신했거나 오류가 발생했음을 알려주는 것     
   
즉, 상호간에 네트워크 연결 합의하에 데이터를 보내고, 성공적으로 수신할 때까지 재 전송해준다.        

## 📖 TCP 연결형 데이터 서비스    
* `데이터 전송 서비스`는     
두 통신 프로세스간에 **양방향**으로 동시에 데이터를 전송할 수 있는 **이중 방식 서비스를 말한다.**         
       
* `연결 지향형 프로토콜`은   
송수신측 컴퓨터가 **데이터를 전송하기 전**에        
먼저 **데이터를 송수신할 수 있는 열결 통로를 만들고 데이터를 전송**하는 프로토콜이다.        
이후 연결 상태를 확인하고 데이터를 전송하고 통신을 종료할 때 까지, 연결 상태를 유지한다.       
또한, **데이터가 잘 전송되었는지 확인하여 신뢰성 있는 데이터 전송을 보장한다.**     
TCP는 대표적인 연결 지향형 프로토콜이다.    

## 📖 포트번호    
포트가 뜬금없이 왜나왔지? 🤔 라고 생각할 수 있지만,      
포트는 **TCP가 상위 계층으로 데이터를 전송하거나**         
**상위 계층에서 TCP로 데이터를 전송할 때 상호간에 사용하는 데이터의 이동 통로를 말한다.***    

```
여기서 말하는 상위 계층인란 건 잘 모르겠습니다. 
```

추가로, **상위 계층 프로토콜과 하위 계층 프로토콜이 같은 포트를 사용해야만 한다.**           
즉, 접속할 때 요청하는 포트 번호는 송신자와 수신자의 포트 번호임을 알 수 있다.      
  
데이터를 전송할 때는, 수신 측의 IP 주소가 필요하지만,      
**어떤 애플리케이션이 사용되고 있는지 구분하려면 TCP는 포트 번호가 필요하다.**    

## 📖 TCP 세그먼트   
![tcp segment](https://user-images.githubusercontent.com/50267433/106351089-4a7f7300-631d-11eb-92eb-8e3e6ec0a9f3.PNG)    
     
TCP 프로토콜은 전송을 위해 바이트 스트림을 세그먼트 단위로 나눈다. (세그먼트는 고정된 크기)            
**세그먼트**는 TCP를 이용하여 두 장치간에 **전달하는 데이터의 단위**를 말한다.         
   
TCP로 데이터를 전송하면, **TCP 데이터에 TCP 헤더가 붙고**, 이를 **TCP 세그먼트**라 부른다.       
   
그리고 이 TCP 헤더에는 실제 데이터를 보조해주는 다양한 정보들이 있다.    
  
* 송신지 포트 번호 16bit
* 수신지 포트 번호 16bit
* 순서 번호 32bit
* 확인 응답 번호 32bit
* 헤더 길이 4bit
* 예약 6bit
* **코드 비트 6bit**
* 검사합 비트 16bit
* 윈도우 크기 1bit
* 긴급 포인터 16bit
* 옵션, 패딩       
       
여기서 나머지 내용들은 생략하고 가장 중요한 **코드 비트를 설명**하려 한다.        

### 📄 코드 비트   
코드 비트는 TCP 헤더의 107-112번째 비트로, **연결 제어 정보가 기록되어 있는 비트다.**    
107-112비트까지, 총 6개로 비트별로 역할이 정해져 있다.        
공통적으로 비트의 초기값은 0이고, 활성화 되면 1의 값을 가진다.(비트니까..)   
   
데이터를 전송할 때 연결을 확립하려면    
* **SYN :** 연결을 요청하는 비트    
* **ACK :** 확인을 응답하는 비트   
가 필요하다.     
 
|코드 비트|설명|      
|--------|----|  
|URG|긴급하게 처리할 데이터가 들어 있음|   
|URG|응답 확인 번호 사용|    
|PSH|TCP가 받은 데이터를 상위 계층에 전달|    
|RST|연결 재설정|    
|SYN|연결을 초기화하려고 순서 번호 동기화|     
|FIN|데이터 송신 종료|        
  




# UDP  
